{% extends 'base.html' %}
{% load static %}

{% block title %}{{ game_task.name }} – Waiting room{% endblock title %}

{% block base %}
<div class="max-w-screen-md w-full mx-auto space-y-6 py-16">
    <div class="w-64 mx-auto">
        <img src="{% static 'images/logo.svg' %}" alt="" class="w-full">
    </div> 
    <div class="grid gap-4 text-center">
        <div class="space-y-2">
            <h1 class="text-xl md:text-2xl lg:text-3xl xl:text-4xl font-black">
                {{ game_task.name }}
            </h1>
            <p class="text-sm text-muted">
                Статус: {{ session.get_status_display }}
            </p>
        </div>

        <form
            method="post"
            action="{% url 'teacher:session_start' game_task.id session.id %}"
            class="flex justify-center"
        >
            {% csrf_token %}
            <button
                type="submit"
                class="
                    flex px-4 py-2 rounded-xl bg-primary-600 text-white font-medium transition-all cursor-pointer hover:bg-primary-800
                    active:scale-95 focus:ring-4 focus:ring-primary-300     
                "
            >
                Сессияны бастау
            </button>
        </form>
    </div>

    <div class="flex gap-4">
        <div class="space-y-4">
            <div class="p-6 border space-y-2 border-border-200 rounded-xl">
                <h4 class="font-medium">PIN код</h4>
                <h1 class="text-5xl font-black tracking-widest">{{ session.pin_code }}</h1>
            </div>

            <div class="p-6 border space-y-2 border-border-200 rounded-xl">
                <h4 class="font-medium">Қатысушылар үшін сілтеме</h4>
                <div class="break-all border border-border-200 rounded-xl p-2 bg-primary-50 text-subtle">
                    {{ join_url }}
                </div>
                <!-- {# QR кодты кейін JS/қызмет арқылы жасаймыз (мысалы, QR сервер, немесе JS-библиотека) #} -->
                <div id="qr-code"></div>
            </div>
        </div>

        <div class="flex-1 p-6 border border-border-200 rounded-xl">
            <div class="flex items-center justify-between mb-2">
                <h4 class="font-medium">Қатысушылар</h4>
            </div>

            <div
                id="participants-list"
                hx-get="{% url 'teacher:session_participants_fragment' game_task.id session.id %}"
                hx-trigger="load, every 5s"
                hx-target="#participants-list"
                hx-swap="innerHTML"
            >
                <div class="grid gap-2 text-center">
                    <p class="text-sm text-muted">Қатысушылар күтілуде...</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock base %}