{% extends "base.html" %}

{% block title %}Ойын нәтижесі{% endblock title %}

{% block base %}
<div class="min-h-screen flex items-center justify-center py-8 px-4">
    {% if attempts %}
        <div class="w-full max-w-md space-y-4">
            {% for attempt in attempts %}
                {% with q=attempt.question %}
                    <div class="border border-border-200 rounded-xl p-4 space-y-4">
                        <div class="flex items-center justify-between gap-2">
                            <h6 class="font-bold">{{ forloop.counter }}-сұрақ</h6>
                            <div class="flex gap-1 items-center">
                                <span class="
                                    flex gap-1 items-center px-1.5 py-1 rounded-xl
                                    {% if attempt.is_correct %}bg-emerald-100 text-emerald-600
                                    {% else %}bg-red-100 text-red-600{% endif %}
                                ">
                                    {% if attempt.is_correct %}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path fill-rule="evenodd"
                                                d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z"
                                                clip-rule="evenodd" />
                                        </svg>
                                        <span class="font-medium text-xs">Дұрыс</span>
                                    {% else %}
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                            <path fill-rule="evenodd"
                                                d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z"
                                                clip-rule="evenodd" />
                                        </svg>
                                        <span class="font-medium text-xs">Қате</span>
                                    {% endif %}
                                </span>
                                <span class="flex items-center gap-1 px-1.5 py-1 rounded-xl bg-amber-100">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="text-amber-500" viewBox="0 0 24 24" fill="currentColor">
                                        <path fill-rule="evenodd"
                                            d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z"
                                            clip-rule="evenodd" />
                                    </svg>
                                    <span class="text-xs font-medium">{{ attempt.score }}</span>
                                </span>
                            </div>
                        </div>

                        <div class="font-medium">{{ q.body|safe }}</div>

                        <!-- Сұрақ форматы (test, matching, ...) -->
                        {% include "./"|add:q.format.code|add:"/_review.html" %}

                        <div class="flex gap-1 items-center text-xs text-muted">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-timer-icon lucide-timer">
                                <line x1="10" x2="14" y1="2" y2="2" />
                                <line x1="12" x2="15" y1="14" y2="11" />
                                <circle cx="12" cy="14" r="8" />
                            </svg>
                            <span>{{ attempt.time_spent }} сек</span>
                        </div>
                    </div>
                {% endwith %}
            {% endfor %}
        </div>
    {% endif %}
</div>

<div 
    hx-get="{% url 'main:gameplay_result_poll' participant.token %}" 
    hx-trigger="load, every 5s"
    hx-swap="none"
></div>
{% endblock base %}
