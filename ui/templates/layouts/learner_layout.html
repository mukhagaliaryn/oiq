{% extends 'base.html' %}
{% load static %}


{% block base %}
<div class="flex">
    <aside class="sticky top-0 w-auto lg:w-80 h-screen flex flex-col justify-between border-r border-border-200 pt-8 px-2 lg:px-4 pb-4">
        <div>
            <div class="relative mb-4">
                <a 
                    href="{% if user.is_authenticated %}{% url 'learner_dashboard' %}{% else %}{% url 'main' %}{% endif %}"
                    class="hidden lg:inline-block border border-transparent transition-all active:border active:border-dashed active:border-muted active:scale-95"
                >
                    <img src="{% static 'images/full-logo.svg' %}" class="w-28" alt="">
                </a>
                <a 
                    href="{% if user.is_authenticated %}{% url 'learner_dashboard' %}{% else %}{% url 'main' %}{% endif %}"
                    class="flex lg:hidden justify-center border border-transparent transition-all active:border active:border-dashed active:border-muted active:scale-95"
                >
                    <img src="{% static 'images/logo.svg' %}" class="w-10" alt="">
                </a>
            </div>

            <ul class="grid gap-1">
                <li>
                    <a 
                        href="{% url 'learner_dashboard' %}" 
                        class="flex gap-2 items-center px-4 py-4 lg:py-2 rounded-xl transition-all hover:shadow-md active:scale-95 {% if request.path == '/learn/' %}bg-primary-500 text-white hover:bg-primary-600{% else %}hover:bg-secondary-100{% endif %}"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-house-icon lucide-house">
                            <path d="M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8" />
                            <path d="M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                        </svg>
                        <span class="hidden lg:block">Басты бет</span>
                    </a>
                </li>

                <li>
                    <a 
                        href="{% url 'learner_games' %}" 
                        class="flex gap-2 items-center px-4 py-4 lg:py-2 rounded-xl transition-all active:scale-95 {% if request.path == '/learn/games/' %}bg-primary-500 text-white hover:bg-primary-600{% else %}hover:bg-secondary-100{% endif %}"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-gamepad2-icon lucide-gamepad-2">
                            <line x1="6" x2="10" y1="11" y2="11" />
                            <line x1="8" x2="8" y1="9" y2="13" />
                            <line x1="15" x2="15.01" y1="12" y2="12" />
                            <line x1="18" x2="18.01" y1="10" y2="10" />
                            <path
                                d="M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z" />
                        </svg>
                        <span class="hidden lg:block">Жарыстар</span>
                    </a>
                </li>
            </ul>
        </div>

        <div class="p-4" x-data="{ openUserDropdown: false }">
            <button
                @click="openUserDropdown = !openUserDropdown"
                class="w-full flex items-start gap-2 transition-all hover:shadow-xs hover:bg-secondary-100 p-2 rounded-xl active:scale-95 cursor-pointer"
            >
                <div class="border-2 border-border-200 rounded-full">
                    {% if user.avatar %}
                        <img class="w-10 h-10 rounded-full" src="/docs/images/people/profile-picture-3.jpg" alt="user photo">
                    {% else %}
                        <div class="w-10 h-10 rounded-full bg-secondary-100 flex items-center justify-center text-foreground">
                            {{ user.first_name|first|upper }}{{ user.last_name|first|upper }}
                        </div>
                    {% endif %}
                </div>
                <div class="block text-left">
                    <h1 class="font-medium">{{ user.get_full_name }}</h1>
                    <span class="block text-sm">{{ user.email }}</span>
                </div>
            </button>

            <div 
                x-show="openUserDropdown"
                @click.outside="openUserDropdown = false"
                class="fixed bottom-24 z-10 bg-white p-2 rounded-xl overflow-hidden shadow-xs border border-border-200 w-64"
            >
                <ul>
                    <li>
                        <a 
                            href="#"
                            class="flex gap-1 items-center px-4 py-2 rounded-xl transition-all hover:bg-secondary-100"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-user-round-icon lucide-user-round">
                                <circle cx="12" cy="8" r="5" />
                                <path d="M20 21a8 8 0 0 0-16 0" />
                            </svg>
                            <span>Профиль</span>
                        </a>
                    </li>
                    <li>
                        <a 
                            href="#"
                            class="flex gap-1 items-center px-4 py-2 rounded-xl transition-all hover:bg-secondary-100"
                        >
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-settings-icon lucide-settings">
                                <path
                                    d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915" />
                                <circle cx="12" cy="12" r="3" />
                            </svg>
                            <span>Баптаулар</span>
                        </a>
                    </li>
                    <li>
                        <form action="{% url 'main:logout' %}">
                            <button 
                                type="submit" 
                                class="w-full flex gap-1 items-center px-4 py-2 rounded-xl transition-all cursor-pointer hover:bg-secondary-100"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-log-out-icon lucide-log-out">
                                    <path d="m16 17 5-5-5-5" />
                                    <path d="M21 12H9" />
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                                </svg>
                                <span>Шығу</span>
                            </button>
                        </form>
                    </li>
                </ul>
            </div>
        </div>
    </aside>
    
    <div class="flex-1 flex max-w-screen-md mx-auto w-full">
        <div class="w-full mx-auto px-4 lg:px-8 py-8">
            {% block learner_layout %}
            {% endblock learner_layout %}
        </div>
    </div>

</div>
{% endblock base %}